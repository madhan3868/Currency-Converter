<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rock Paper and Scissors Game</title>

    <style>
        body {
            background-color: lightgray;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .play-buttons button {
            width: 100px;
            height: 100px;
            border-radius: 50px;
            border: 1px solid gray;
            background-color: lightgrey;
        }
        
        .result {
            font-size: 25px;
            display: flex;
            justify-content: center;
        }
        
        .advanced-buttons button {
            border: none;
            padding: 10px 20px;
            font-size: 20px;
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <h1>Rock Paper and Scissors</h1>
    <div class="play-buttons">
        <button class="js-rock"> <img src="images/Rock-emoji.png" alt="file is missing" width="50px"></button>
        <button class="js-paper"><img src="images/Paper-emoji.png" alt="file is missing" width="50px"></button>
        <button class="js-scissors"><img src="images/Scissors-emoji.png" alt="file is missing" width="50px"></button>
    </div>
    <div style="font-family: arial;">
        <p class="js-moves"></p>
        <p class="js-result result"></p>
        <p class="js-score"></p>
    </div>
    <div class="advanced-buttons">
        <button class="js-reset">Reset</button>
        <button class="js-auto-play">Auto Play</button>
    </div>

    <script>
        document.querySelector('.js-rock').addEventListener('click', () => {
            playerMove('rock');
        });
        document.querySelector('.js-paper').addEventListener('click', () => {
            playerMove('paper');
        });
        document.querySelector('.js-scissors').addEventListener('click', () => {
            playerMove('scissors');
        });

        document.querySelector('.js-reset').addEventListener('click', () => {

            resetButton()
        });

        function resetButton() {

            score.wins = 0;
            score.losess = 0;
            score.ties = 0;

            localStorage.removeItem('Score');

            document.querySelector('.js-moves').innerHTML = '';

            document.querySelector('.js-result').innerHTML = 'You\'r score is reset'

            document.querySelector('.js-score').innerHTML = `Wins : ${score.wins} Losess: ${score.losess} Ties: ${score.ties}`
        }

        document.querySelector('.js-auto-play').addEventListener('click', () => {
            autoPlaying();
        });

        // setInterval functions are used outside of a Event Listener

        let autoPlay = true;
        let interVal;

        function autoPlaying() {
            if (autoPlay) {
                interVal = setInterval(() => {
                    const bot = computerGenratedMove();

                    playerMove(bot);

                }, 1000);
                autoPlay = false;
            } else {
                clearInterval(interVal);
                autoPlay = true;
            }
        };

        document.body.addEventListener('keydown', (event) => {
            if (event.key === 'r' || event.key === 'R') {
                playerMove('Rock');
            } else if (event.key === 'p' || event.key === 'P') {
                playerMove('Paper');
            } else if (event.key === 's' || event.key === 'S') {
                playerMove('Scissors');
            }
            if (event.key === 'Backspace') {
                resetButton();
            } else if (event.key === 'a' || event.key === 'A') {
                autoPlaying();
            }
        });

        const score = JSON.parse(localStorage.getItem('Score')) || {
            wins: 0,
            losess: 0,
            ties: 0
        }

        // if (!score){
        //     score = {
        //         wins: 0, 
        //         losess: 0,
        //         ties: 0
        //     }
        // }



        function playerMove(move) {

            const computerMove = computerGenratedMove();

            console.log('computers Move', computerMove)
            console.log('You\'s move', move);

            let result = '';

            if (move === 'rock' && computerMove === 'scissors') {
                result = 'You Won!';
            } else if (move === 'rock' && computerMove === 'paper') {
                result = 'You Lost!';
            } else if (move === 'rock' && computerMove === 'rock') {
                result = 'Tie!'
            }
            if (move === 'paper' && computerMove === 'rock') {
                result = 'You Won!';
            } else if (move === 'paper' && computerMove === 'scissors') {
                result = 'You Lost!';
            } else if (move === 'paper' && computerMove === 'paper') {
                result = 'Tie!'
            }
            if (move === 'scissors' && computerMove === 'paper') {
                result = 'You Won!';
            } else if (move === 'scissors' && computerMove === 'rock') {
                result = 'You Lost!';
            } else if (move === 'scissors' && computerMove === 'scissors') {
                result = 'Tie!'
            }

            // console.log(result);
            if (result === 'You Won!') {
                score.wins += 1;
            } else if (result === 'You Lost!') {
                score.losess += 1
            } else if (result === 'Tie!') {
                score.ties += 1
            }

            localStorage.setItem('Score', JSON.stringify(score));

            document.querySelector('.js-moves').innerHTML = `You choose: <img src="images/${move}-emoji.png" alt="file is missing" width="50px"> Computer choose: <img src="images/${computerMove}-emoji.png" alt="file is missing" width="50px">`;

            document.querySelector('.js-result').innerHTML = `${result}`;

            localStorage.getItem('Score')

            document.querySelector('.js-score').innerHTML = `Wins : ${score.wins} Losess: ${score.losess} Ties: ${score.ties}`

            // alert(`You choose: ${move} \n Computer choose: ${computerMove} \n and ${result} `)
        }

        function computerGenratedMove() {
            const randomNumber = Math.random();
            console.log(randomNumber);
            if (randomNumber > 0 && randomNumber < 1 / 3) {
                return 'rock';
            } else if (randomNumber > 1 / 3 && randomNumber < 2 / 3) {
                return 'paper';
            } else {
                return 'scissors';
            }
        }
    </script>
</body>

</html>